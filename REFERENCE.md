# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`postfixadmin`](#postfixadmin): Postfixadmin main class
* [`postfixadmin::cli::params`](#postfixadmincliparams): Class to set the postfixadmin client program to use  Parameters:
* [`postfixadmin::config`](#postfixadminconfig): class for postfixadmin configuration
* [`postfixadmin::db`](#postfixadmindb): install database
* [`postfixadmin::db::mysql`](#postfixadmindbmysql): privat class to manage mysql db use postfixadmin::db instead
* [`postfixadmin::fix_debian_bug`](#postfixadminfix_debian_bug): This fixes debian bug #856338  see: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=856338
* [`postfixadmin::install`](#postfixadmininstall): install packages
* [`postfixadmin::queries::dovecot`](#postfixadminqueriesdovecot): class to create mysql maps for postfix  Parameters:
* [`postfixadmin::queries::postfix`](#postfixadminqueriespostfix): class to create mysql maps for postfix
* [`postfixadmin::vhost`](#postfixadminvhost): This class chooses the type of vhost to run webserver
* [`postfixadmin::vhost::apache`](#postfixadminvhostapache): internal class that installs an apache vhost Parameters are inherited from postfixadmin::vhost

### Defined types

* [`postfixadmin::cli::create_admin`](#postfixadminclicreate_admin): This define just ensures that a an admin account exists.
* [`postfixadmin::cli::create_aliasdomain`](#postfixadminclicreate_aliasdomain): define to ensure an aliasdomain exists
* [`postfixadmin::cli::create_domain`](#postfixadminclicreate_domain): Ensures, that a domain exists But does not modify any domains
* [`postfixadmin::domain`](#postfixadmindomain): helper define to create domains

### Functions

* [`postfixadmin_generate_pw`](#postfixadmin_generate_pw)

## Classes

### <a name="postfixadmin"></a>`postfixadmin`

Postfixadmin main class

#### Parameters

The following parameters are available in the `postfixadmin` class:

* [`ensure_database`](#ensure_database)
* [`ensure_vhost`](#ensure_vhost)
* [`ensure_postfix_queries`](#ensure_postfix_queries)
* [`ensure_dovecot_queries`](#ensure_dovecot_queries)
* [`admins`](#admins)
* [`domains`](#domains)
* [`aliasdomains`](#aliasdomains)
* [`dovecot_classes`](#dovecot_classes)
* [`postfix_classes`](#postfix_classes)

##### <a name="ensure_database"></a>`ensure_database`

Data type: `Boolean`

if true a database is created
Defaults to false

Default value: ``false``

##### <a name="ensure_vhost"></a>`ensure_vhost`

Data type: `Boolean`

if true a virtualhost is created
Defaults to false

Default value: ``false``

##### <a name="ensure_postfix_queries"></a>`ensure_postfix_queries`

Data type: `Boolean`

if true the maps querying the database
for postfix are created
Defaults to false

Default value: ``false``

##### <a name="ensure_dovecot_queries"></a>`ensure_dovecot_queries`

Data type: `Boolean`

if true the maps querying the database
for dovecot are created
Defaults to false

Default value: ``false``

##### <a name="admins"></a>`admins`

Data type: `Hash`

Hash of hashes to create postfixadmin::cli::create_admin
Defaults to {}

Default value: `{}`

##### <a name="domains"></a>`domains`

Data type: `Hash`

Hash of hases to create postfixadmin::cli::create_domain
Defaults to {}

Default value: `{}`

##### <a name="aliasdomains"></a>`aliasdomains`

Data type: `Hash`

Hash of hases to create postfixadmin::cli::create_aliasdomain
Defaults to {}

Default value: `{}`

##### <a name="dovecot_classes"></a>`dovecot_classes`

Data type: `Array`

Array of classnames that are required for devecot
query installation (defaults to ['dovecot'])

Default value: `['dovecot']`

##### <a name="postfix_classes"></a>`postfix_classes`

Data type: `Array`

Array of classnames that are required for postfix
query installation (defaults to ['postfix'])

Default value: `['postfix']`

### <a name="postfixadmincliparams"></a>`postfixadmin::cli::params`

Class to set the postfixadmin client program to use

Parameters:

#### Parameters

The following parameters are available in the `postfixadmin::cli::params` class:

* [`path`](#path)
* [`cmd`](#cmd)

##### <a name="path"></a>`path`

Data type: `Any`



Default value: `['/bin','/usr/bin']`

##### <a name="cmd"></a>`cmd`

Data type: `Any`

the postfixadmin-cli program
defaults to:
'bash /usr/share/postfixadmin/scripts/postfixadmin-cli'

Default value: `'bash /usr/share/postfixadmin/scripts/postfixadmin-cli'`

### <a name="postfixadminconfig"></a>`postfixadmin::config`

class for postfixadmin configuration

#### Parameters

The following parameters are available in the `postfixadmin::config` class:

* [`config_file`](#config_file)
* [`configs`](#configs)
* [`owner`](#owner)
* [`group`](#group)
* [`mode`](#mode)

##### <a name="config_file"></a>`config_file`

Data type: `String`

configuration file to use

Default value: `'/etc/postfixadmin/config.local.php'`

##### <a name="configs"></a>`configs`

Data type: `Hash`

Hash of configuration variables to set.
Defaults to {}

Default value: `{}`

##### <a name="owner"></a>`owner`

Data type: `String`

configfile owner

Default value: `'root'`

##### <a name="group"></a>`group`

Data type: `String`

configfile group

Default value: `'www-data'`

##### <a name="mode"></a>`mode`

Data type: `String`

configfile mode

Default value: `'0640'`

### <a name="postfixadmindb"></a>`postfixadmin::db`

install database

#### Parameters

The following parameters are available in the `postfixadmin::db` class:

* [`dbpass`](#dbpass)
* [`dbtype`](#dbtype)
* [`dbname`](#dbname)
* [`dbuser`](#dbuser)
* [`basepath`](#basepath)
* [`dbport`](#dbport)
* [`host`](#host)
* [`host_config`](#host_config)
* [`dbconfig_inc`](#dbconfig_inc)

##### <a name="dbpass"></a>`dbpass`

Data type: `String`

password to connect to the database.

Default value: `'CHANGEME'`

##### <a name="dbtype"></a>`dbtype`

Data type: `String`

database type to use currently mysql or mysqli
is supported.

Default value: `'mysql'`

##### <a name="dbname"></a>`dbname`

Data type: `String`

name of the database
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="dbuser"></a>`dbuser`

Data type: `String`

username to connect to the database.
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="basepath"></a>`basepath`

Data type: `String`

basepath for database, defaults to ''

Default value: `''`

##### <a name="dbport"></a>`dbport`

Data type: `String`

port to connect to db defaults to '3306' (mysql)

Default value: `'3306'`

##### <a name="host"></a>`host`

Data type: `String`

host that is allowed to connect for database creation
defaults to 'localhost'

Default value: `'localhost'`

##### <a name="host_config"></a>`host_config`

Data type: `Optional[String]`

host that is used to connect to database
defaults to same as host.

Default value: ``undef``

##### <a name="dbconfig_inc"></a>`dbconfig_inc`

Data type: `String`

where to write the db config.
defaults to '/etc/postfixadmin/dbconfig.inc.php'
if you do not want to write, set it to ''

Default value: `'/etc/postfixadmin/dbconfig.inc.php'`

### <a name="postfixadmindbmysql"></a>`postfixadmin::db::mysql`

privat class to manage mysql db
use postfixadmin::db instead

#### Parameters

The following parameters are available in the `postfixadmin::db::mysql` class:

* [`dbname`](#dbname)
* [`dbuser`](#dbuser)
* [`dbpass`](#dbpass)
* [`host`](#host)

##### <a name="dbname"></a>`dbname`

Data type: `Any`



Default value: `$postfixadmin::db::dbname`

##### <a name="dbuser"></a>`dbuser`

Data type: `Any`



Default value: `$postfixadmin::db::dbuser`

##### <a name="dbpass"></a>`dbpass`

Data type: `Any`



Default value: `$postfixadmin::db::dbpass`

##### <a name="host"></a>`host`

Data type: `Any`



Default value: `$postfixadmin::db::host`

### <a name="postfixadminfix_debian_bug"></a>`postfixadmin::fix_debian_bug`

This fixes debian bug #856338

see:
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=856338

#### Parameters

The following parameters are available in the `postfixadmin::fix_debian_bug` class:

* [`docroot`](#docroot)

##### <a name="docroot"></a>`docroot`

Data type: `String`

the document root

Default value: `'/usr/share/postfixadmin'`

### <a name="postfixadmininstall"></a>`postfixadmin::install`

install packages

#### Parameters

The following parameters are available in the `postfixadmin::install` class:

* [`package_name`](#package_name)
* [`packages`](#packages)
* [`package_ensure`](#package_ensure)

##### <a name="package_name"></a>`package_name`

Data type: `String`

name of the package to install

Default value: `'postfixadmin'`

##### <a name="packages"></a>`packages`

Data type: `Array`

additional packages to install

Default value: `[]`

##### <a name="package_ensure"></a>`package_ensure`

Data type: `String`

what to ensure for packages

Default value: `'installed'`

### <a name="postfixadminqueriesdovecot"></a>`postfixadmin::queries::dovecot`

class to create mysql maps for postfix

Parameters:

#### Parameters

The following parameters are available in the `postfixadmin::queries::dovecot` class:

* [`dbpass`](#dbpass)
* [`dbuser`](#dbuser)
* [`dbname`](#dbname)
* [`host`](#host)
* [`mysql_flags`](#mysql_flags)
* [`dir`](#dir)
* [`owner`](#owner)
* [`group`](#group)
* [`mode`](#mode)
* [`default_password_scheme`](#default_password_scheme)
* [`mboxpath`](#mboxpath)
* [`uid`](#uid)
* [`gid`](#gid)
* [`quota`](#quota)

##### <a name="dbpass"></a>`dbpass`

Data type: `String`

password to connect to the database.

Default value: `'CHANGEME'`

##### <a name="dbuser"></a>`dbuser`

Data type: `String`

username to connect to the database.
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="dbname"></a>`dbname`

Data type: `String`

name of the database
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="host"></a>`host`

Data type: `String`

host to connect to.
defaults to localhost

Default value: `'localhost'`

##### <a name="mysql_flags"></a>`mysql_flags`

Data type: `Array`

Array of additional flags for connecting to mysql
eg. ssl settings. defaults to []

Default value: `[]`

##### <a name="dir"></a>`dir`

Data type: `String`

directory to place the map

Default value: `'/etc/dovecot/postfixadmin'`

##### <a name="owner"></a>`owner`

Data type: `String`

owner of the map files

Default value: `'root'`

##### <a name="group"></a>`group`

Data type: `String`

group of the map files

Default value: `'root'`

##### <a name="mode"></a>`mode`

Data type: `String`

mode of the map files

Default value: `'0640'`

##### <a name="default_password_scheme"></a>`default_password_scheme`

Data type: `String`

change to match your Postfixadmin setting.
depends on your $CONF['encrypt'] setting
defaults to 'MD5-CRYPT'

Default value: `'MD5-CRYPT'`

##### <a name="mboxpath"></a>`mboxpath`

Data type: `String`

path to the mbailboxes

Default value: `''`

##### <a name="uid"></a>`uid`

Data type: `String`

uid to use for mailboxes
must matche dovecot.conf AND Postfix virtual_uid_maps parameter
defaults to '' (not included in query)

Default value: `''`

##### <a name="gid"></a>`gid`

Data type: `String`

gid to use for mailboxes
must matche dovecot.conf AND Postfix virtual_gid_maps parameter
defaults to '' (not included in query)

Default value: `''`

##### <a name="quota"></a>`quota`

Data type: `Boolean`

if true quota is included in the query
defaults to true

Default value: ``true``

### <a name="postfixadminqueriespostfix"></a>`postfixadmin::queries::postfix`

class to create mysql maps for postfix

#### Parameters

The following parameters are available in the `postfixadmin::queries::postfix` class:

* [`dbpass`](#dbpass)
* [`dbuser`](#dbuser)
* [`dbname`](#dbname)
* [`hosts`](#hosts)
* [`dir`](#dir)
* [`owner`](#owner)
* [`group`](#group)
* [`mode`](#mode)
* [`allow_account_as_sender`](#allow_account_as_sender)

##### <a name="dbpass"></a>`dbpass`

Data type: `String`

password to connect to the database.

Default value: `'CHANGEME'`

##### <a name="dbuser"></a>`dbuser`

Data type: `String`

username to connect to the database.
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="dbname"></a>`dbname`

Data type: `String`

name of the database
defaults to: 'postfixadmin'

Default value: `'postfixadmin'`

##### <a name="hosts"></a>`hosts`

Data type: `Array`

Array of hosts to connect to.
defaults to ['localhost']

Default value: `[ 'localhost' ]`

##### <a name="dir"></a>`dir`

Data type: `String`

directory to place the map

Default value: `'/etc/postfix/postfixadmin'`

##### <a name="owner"></a>`owner`

Data type: `String`

owner of the map files

Default value: `'root'`

##### <a name="group"></a>`group`

Data type: `String`

group of the map files

Default value: `'postfix'`

##### <a name="mode"></a>`mode`

Data type: `String`

mode of the map files

Default value: `'0640'`

##### <a name="allow_account_as_sender"></a>`allow_account_as_sender`

Data type: `Boolean`

used for mysql_sender_access if set to true
add the account as a permitted sender address.
this allows to create send only accounts which do not
receive any mails (eg. sender address is aliased to another
mailbox). Accounts needs to be formated as email adresses for
this to work !

Default value: ``false``

### <a name="postfixadminvhost"></a>`postfixadmin::vhost`

This class chooses the type of vhost
to run webserver

#### Parameters

The following parameters are available in the `postfixadmin::vhost` class:

* [`vhosttype`](#vhosttype)
* [`servername`](#servername)
* [`serveraliases`](#serveraliases)
* [`docroot`](#docroot)
* [`ssl`](#ssl)
* [`ssl_cert`](#ssl_cert)
* [`ssl_key`](#ssl_key)
* [`ssl_chain`](#ssl_chain)
* [`port`](#port)
* [`redirect_to_ssl`](#redirect_to_ssl)
* [`create_resources`](#create_resources)

##### <a name="vhosttype"></a>`vhosttype`

Data type: `String`

type of vhost to run. currently only apache supported (default)

Default value: `'apache'`

##### <a name="servername"></a>`servername`

Data type: `String`

Servername (defaults to $::fqdn)

Default value: `$::fqdn`

##### <a name="serveraliases"></a>`serveraliases`

Data type: `Array`

Array of Serveraliasess to listen to (default [])

Default value: `[]`

##### <a name="docroot"></a>`docroot`

Data type: `String`

Document root

Default value: `'/usr/share/postfixadmin'`

##### <a name="ssl"></a>`ssl`

Data type: `Boolean`

If true, use ssl (defaults to false)
If true, you also need to set cert, key and chain.

Default value: ``false``

##### <a name="ssl_cert"></a>`ssl_cert`

Data type: `String`

ssl cert to use

Default value: `unset`

##### <a name="ssl_key"></a>`ssl_key`

Data type: `String`

ssl key to use

Default value: `unset`

##### <a name="ssl_chain"></a>`ssl_chain`

Data type: `String`

ssl chain to use

Default value: `unset`

##### <a name="port"></a>`port`

Data type: `String`

port to use (default 443)

Default value: `'443'`

##### <a name="redirect_to_ssl"></a>`redirect_to_ssl`

Data type: `Boolean`

if true, redirects all non https requests to https
defaults to true.

Default value: ``true``

##### <a name="create_resources"></a>`create_resources`

Data type: `Hash`

a Hash of Hashes to create additional resources eg. to
retrieve a certificate.
Defaults to {} (do not create any additional resources)
Example (hiera):

postfixadmin::vhost::create_resources:
    sslcert::get_cert:
        get_my_postfix_cert:
          private_key_path: '/etc/postfixadmin/ssl/key.pem'
          cert_path: '/etc/postfixadmin/ssl/cert.pem'

Will result in  executing:

sslcert::get_cert{'get_my_postfix_cert':
  private_key_path => '/etc/postfixadmin/ssl/key.pem'
  cert_path        => '/etc/postfixadmin/ssl/cert.pem'
}

Default value: `{}`

### <a name="postfixadminvhostapache"></a>`postfixadmin::vhost::apache`

internal class that installs an apache vhost
Parameters are inherited from postfixadmin::vhost

#### Parameters

The following parameters are available in the `postfixadmin::vhost::apache` class:

* [`servername`](#servername)
* [`serveraliases`](#serveraliases)
* [`docroot`](#docroot)
* [`apache_vhost`](#apache_vhost)
* [`ssl`](#ssl)
* [`ssl_cert`](#ssl_cert)
* [`ssl_key`](#ssl_key)
* [`ssl_chain`](#ssl_chain)
* [`port`](#port)
* [`redirect_to_ssl`](#redirect_to_ssl)

##### <a name="servername"></a>`servername`

Data type: `String`



Default value: `$postfixadmin::vhost::servername`

##### <a name="serveraliases"></a>`serveraliases`

Data type: `Array`



Default value: `$postfixadmin::vhost::serveraliases`

##### <a name="docroot"></a>`docroot`

Data type: `String`



Default value: `$postfixadmin::vhost::docroot`

##### <a name="apache_vhost"></a>`apache_vhost`

Data type: `Hash`



Default value: `{}`

##### <a name="ssl"></a>`ssl`

Data type: `Boolean`



Default value: `$postfixadmin::vhost::ssl`

##### <a name="ssl_cert"></a>`ssl_cert`

Data type: `String`



Default value: `$postfixadmin::vhost::ssl_cert`

##### <a name="ssl_key"></a>`ssl_key`

Data type: `String`



Default value: `$postfixadmin::vhost::ssl_key`

##### <a name="ssl_chain"></a>`ssl_chain`

Data type: `String`



Default value: `$postfixadmin::vhost::ssl_chain`

##### <a name="port"></a>`port`

Data type: `String`



Default value: `$postfixadmin::vhost::port`

##### <a name="redirect_to_ssl"></a>`redirect_to_ssl`

Data type: `Boolean`



Default value: `$postfixadmin::vhost::redirect_to_ssl`

## Defined types

### <a name="postfixadminclicreate_admin"></a>`postfixadmin::cli::create_admin`

This define just ensures that a
an admin account exists.

#### Parameters

The following parameters are available in the `postfixadmin::cli::create_admin` defined type:

* [`admin`](#admin)
* [`password`](#password)
* [`superadmin`](#superadmin)
* [`send_mail`](#send_mail)

##### <a name="admin"></a>`admin`

Data type: `String`

the name of the admin account (needs to be an Email)
Defaults to $title

Default value: `$title`

##### <a name="password"></a>`password`

Data type: `String`

The passord to initialy set. If set to '' (the default) an
random password is generated

Default value: `''`

##### <a name="superadmin"></a>`superadmin`

Data type: `Boolean`

if set to true the admin is a superadmin with access to all domains
Default to false

Default value: ``false``

##### <a name="send_mail"></a>`send_mail`

Data type: `Boolean`

if true, a mail to $admin is sent with password and url

Default value: ``false``

### <a name="postfixadminclicreate_aliasdomain"></a>`postfixadmin::cli::create_aliasdomain`

define to ensure an aliasdomain exists

#### Parameters

The following parameters are available in the `postfixadmin::cli::create_aliasdomain` defined type:

* [`target_domain`](#target_domain)
* [`domain`](#domain)
* [`create_domain`](#create_domain)

##### <a name="target_domain"></a>`target_domain`

Data type: `String`

the domain it points to

##### <a name="domain"></a>`domain`

Data type: `String`

the domain to ensure (defaults to $title)

Default value: `$title`

##### <a name="create_domain"></a>`create_domain`

Data type: `Boolean`

if true (default) we use postfixadmin::cli::create_domain
to create the domain.
if you set this to false you need to create the domain
before using this define.

Default value: ``true``

### <a name="postfixadminclicreate_domain"></a>`postfixadmin::cli::create_domain`

Ensures, that a domain exists
But does not modify any domains

#### Parameters

The following parameters are available in the `postfixadmin::cli::create_domain` defined type:

* [`domain`](#domain)
* [`description`](#description)
* [`aliases`](#aliases)
* [`mailboxes`](#mailboxes)
* [`quota`](#quota)
* [`maxquota`](#maxquota)
* [`default_aliases`](#default_aliases)

##### <a name="domain"></a>`domain`

Data type: `String`

The domain defaults to $title

Default value: `$title`

##### <a name="description"></a>`description`

Data type: `String`

a description defaults to $title

Default value: `$title`

##### <a name="aliases"></a>`aliases`

Data type: `Integer`

amount of Aliases (-1=disable, 0=unlimited)
defaults to false (do not use option)

Default value: `-`

##### <a name="mailboxes"></a>`mailboxes`

Data type: `Integer`

amount of mailboxes (-1=disable, 0=unlimited)
defaults to false (do not use option)

Default value: `-`

##### <a name="quota"></a>`quota`

Data type: `Integer`

domain quota (MB | -1 = disable | 0 = unlimited)
defaults to false (do not use option)

Default value: `-`

##### <a name="maxquota"></a>`maxquota`

Data type: `Integer`

Mailbox Quota (MB) (MB | -1 = disable | 0 = unlimited)
defaults to false (do not use option)

Default value: `-`

##### <a name="default_aliases"></a>`default_aliases`

Data type: `Boolean`

If true (default) set the default aliases

Default value: ``true``

### <a name="postfixadmindomain"></a>`postfixadmin::domain`

helper define to create domains

#### Parameters

The following parameters are available in the `postfixadmin::domain` defined type:

* [`domain`](#domain)
* [`target_domain`](#target_domain)
* [`cli_parameters`](#cli_parameters)

##### <a name="domain"></a>`domain`

Data type: `String`

The domain name defaults to $title

Default value: `$title`

##### <a name="target_domain"></a>`target_domain`

Data type: `String`

if set, an alias domain is created, defaults to ''

Default value: `''`

##### <a name="cli_parameters"></a>`cli_parameters`

Data type: `Hash`

additional parameters for postfixadmin::cli::create_domain
or postfixadmin::cli::create_aliasdomain

Default value: `{}`

## Functions

### <a name="postfixadmin_generate_pw"></a>`postfixadmin_generate_pw`

Type: Ruby 3.x API

The postfixadmin_generate_pw function.

#### `postfixadmin_generate_pw()`

The postfixadmin_generate_pw function.

Returns: `Any`

